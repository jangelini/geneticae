---
title: "Geneticae"
subtitle: "An R package to analyze data from agricultural research"
author: |
    | Julia Angelini
    | Marcos Prunello
    | Gerardo Cervigni
    |
    | Centro de estudios fotosinteticos y bioquimicos
    | Universidad Nacional de Rosario
    | Suipacha 501
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Geneticae}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<!-- devtools::build_vignettes() -->
##1. Getting started

__Installing the package.__ To install the _Geneticae_ package:

```{r,eval=FALSE}
install.packages("devtools")
library(devtools)
install_github("jangelini/geneticae")
```


__Loading the package.__ Once geneticae package is installed, it needs to be made accessible to the current R session by the command. To load the `Geneticae` package in your R session, type `library(Geneticae)`.



__Help files.__  Detailed information on `Geneticae` package functions can be obtained in the help files using `help(package="agricolae")`.
The help file for a function, for example `imputation` in a R session, can be obtained using `?imputation` or `help(imputation)`.


For a complete functionality, geneticae requires other packages

+ stats: for....
+ GGEBiplots
+ GGEBiplots
+ ggforce
+ ggplot2
+ scales
+ MASS
+ pcaMethods
+ rrcov
+ dplyr
+ agricolae
+ bcv
+ missMDA
+ calibrate
+ graphics


##2. Introduction


The geneticae package offers functions for the analysis of genotype interaction by environment, an essential factor in an improvement program.

## 3. Running Geneticae

For the application, we consider the data used in the example of @yan2006biplot:

A list of class \code{GGE_Model} containing:

+ coordgenotype: plotting coordinates for genotypes from all components 
+ coordenviroment: plotting coordinates for environments from all components 
+ eigenvalues:vector of eigenvalues from each component
+ vartotal: overall variance
+ varexpl: percentage of variance explained by each component 
+ labelgen: genotype names
+ labelenv: environment names
+ axes: axis labels
+ Data: scaled and centered input data 
+ centering: name of centering method
+ scaling: name of scaling method
+ SVP: name of SVP method


```{r, tidy=TRUE}
library(geneticae)
library(reshape2)
library(agridat)
data(yan.winterwheat)
dat1 <- yan.winterwheat
dat <-t(round(acast(dat1, env~gen, value.var='yield'),2))

GGE1<-GGEmodel(dat, centering="tester", rep=FALSE)
names(GGE1)
GGE1$varexpl
GGE1$centering
GGE1$scaling
GGE1$SVP
```


The output from the `GGEPlot` function is a biplot constructed through the principal components generated by the genotype plus genotype-by-environment.


```{r, tidy=TRUE,fig.height=5.5, fig.width=5.5}
GGEPlot(GGE1, type="Which Won Where/What")
```


Different types of biplot can be produced:

+ Biplot: Basic biplot.
+ Selected Environment: Ranking the cultivars based on their performance in any given environment.
+ Selected Genotype: Ranking the environments based on the relative performance of any given cultivar.
+ Relationship Among Environments.
+ Comparison of Genotype.
+ Which won where/what: Identifying the ’best’ cultivar in each environment.
+ Discrimination vs.representativeness: Evaluating the environments based on both discriminating ability and representativeness.
+ Ranking environments: Ranking environments with respect to the ideal environment.
+ Mean vs. stability: Evaluating cultivars based on both average yield and stability.
+ Ranking gentoypes: Ranking genotypes with respect to the ideal genotype.

```{r, tidy=TRUE,fig.height=5.5, fig.width=5.5}
GGEPlot(GGE1, type="Mean vs. Stability")
```

```{r, tidy=TRUE,fig.height=5.5, fig.width=5.5}
rAMMI(dat1,type='ppAMMI', rep=FALSE)
```




## 8. Sesssion Info

```{r, tidy=TRUE, echo = FALSE}
sessionInfo()
```
