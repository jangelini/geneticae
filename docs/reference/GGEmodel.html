<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Site Regression model — GGEmodel • geneticae</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Site Regression model — GGEmodel"><meta property="og:description" content="The Site Regression model (also called genotype +
 genotype-by-environment (GGE) model) is a powerful tool for effective
 analysis and interpretation of data from multi-environment trials in
 breeding programs. There are different functions in R to fit the SREG model,
 such as the GGEModel from the
 GGEBiplots package.
 However, this function has the following improvements:
Includes recently published robust versions of the SREG model (Angelini et
 al., 2022).
It can be used for data from trials with repetitions
 (there is no need to calculate means beforehand).
Other variables not
 used in the analysis can be present in the dataset.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geneticae</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/a-tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Functions and datasets reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/b-shiny.html">Shiny APP</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jangelini/geneticae">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Site Regression model</h1>
    <small class="dont-index">Source: <a href="https://github.com/jangelini/geneticae/blob/HEAD/R/GGE_Model.R"><code>R/GGE_Model.R</code></a></small>
    <div class="hidden name"><code>GGEmodel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Site Regression model (also called genotype +
 genotype-by-environment (GGE) model) is a powerful tool for effective
 analysis and interpretation of data from multi-environment trials in
 breeding programs. There are different functions in R to fit the SREG model,
 such as the <code><a href="https://rdrr.io/pkg/GGEBiplots/man/GGEModel.html" class="external-link">GGEModel</a></code> from the
 <a href="https://CRAN.R-project.org/package=GGEBiplots" class="external-link">GGEBiplots package</a>.
 However, this function has the following improvements:</p><ul><li><p>Includes recently published robust versions of the SREG model (Angelini et
 al., 2022).</p></li>
<li><p>It can be used for data from trials with repetitions
 (there is no need to calculate means beforehand).</p></li>
<li><p>Other variables not
 used in the analysis can be present in the dataset.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">GGEmodel</span><span class="op">(</span>
  <span class="va">Data</span>,
  genotype <span class="op">=</span> <span class="st">"gen"</span>,
  environment <span class="op">=</span> <span class="st">"env"</span>,
  response <span class="op">=</span> <span class="st">"yield"</span>,
  rep <span class="op">=</span> <span class="cn">NULL</span>,
  model <span class="op">=</span> <span class="st">"SREG"</span>,
  SVP <span class="op">=</span> <span class="st">"symmetrical"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Data</dt>
<dd><p>dataframe with genotypes, environments, repetitions (if any) and
the phenotypic trait of interest. Additional variables that will not be used
in the model may be present in the data.</p></dd>
<dt>genotype</dt>
<dd><p>column name for genotypes.</p></dd>
<dt>environment</dt>
<dd><p>column name for environments.</p></dd>
<dt>response</dt>
<dd><p>column name for the phenotypic trait.</p></dd>
<dt>rep</dt>
<dd><p>column name for replications. If this argument is NULL, there are
no replications in the data. Defaults to NULL.</p></dd>
<dt>model</dt>
<dd><p>method for fitting the SREG model: `"SREG"`,`"CovSREG"`,`"hSREG"`
or `"ppSREG"` (see References). Defaults to `"SREG"`.</p></dd>
<dt>SVP</dt>
<dd><p>method for singular value partitioning. Either `"row"`, `"column"`,
or `"symmetrical"`. Defaults to `"symmetrical"`.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>GGE_Model</code> containing:</p>
<dl><dt>model</dt>
<dd><p>SREG model
 version.</p></dd>
<dt>coordgenotype</dt>
<dd><p>plotting coordinates for each genotype in
 every component.</p></dd>
<dt>coordenviroment</dt>
<dd><p>plotting coordinates for each
 environment in every component.</p></dd>
<dt>eigenvalues</dt>
<dd><p>vector of eigenvalues
 for each component.</p></dd>
<dt>vartotal</dt>
<dd><p>overall variance.</p></dd>
<dt>varexpl</dt>
<dd><p>percentage of variance explained by each component.</p></dd>
<dt>labelgen</dt>
<dd><p>genotype names.</p></dd>
<dt>labelenv</dt>
<dd><p>environment names.</p></dd>
<dt>axes</dt>
<dd><p>axis labels.</p></dd>
<dt>Data</dt>
<dd><p>scaled and centered input data.</p></dd>
<dt>SVP</dt>
<dd><p>name of SVP method.</p></dd>
</dl><p>A biplot of class <code>ggplot</code></p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A linear model by robust regression using an M estimator proposed by
 Huber (1964, 1973) fitted by iterated re-weighted least squares, in
 combination with three robust SVD/PCA procedures, resulted in a total of
 three robust SREG alternatives. The robust SVD/PCA considered were:</p><ul><li><p>CovSREG: robust PCA that is obtained by replacing the
 classical estimates of location and covariance by their robust analogues
 using Minimum Regularized Covariance Determinant (MRCD) approach;</p></li>
<li><p>hSREG: robust PCA method that tries to combine the advantages of both
 approaches, PCA based on a robust covariance matrix and based on projection
 pursuit;</p></li>
<li><p>ppSREG: robust PCA that uses the projection pursuit and
 directly calculates the robust estimates of the eigenvalues and eigenvectors
 without going through robust covariance estimation. It is a very attractive
 method for bigdata situations, which are very common in METs (a few
 genotypes tested in a large number of environments), as the principal
 components can be calculated sequentially.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Julia Angelini, Gabriela Faviere, Eugenia Bortolotto, Gerardo
 Domingo Lucio Cervigni &amp; Marta Beatriz Quaglino (2022) Handling outliers in
 multi-environment trial data analysis: in the direction of robust SREG
 model, Journal of Crop Improvement, DOI: 10.1080/15427528.2022.2051217</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jangelini.github.io/geneticae/" class="external-link">geneticae</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="co"># Data without replication</span></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span>
<span class="r-in"> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yan.winterwheat</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">GGE1</span> <span class="op">&lt;-</span> <span class="fu">GGEmodel</span><span class="op">(</span><span class="va">yan.winterwheat</span>, genotype<span class="op">=</span><span class="st">"gen"</span>, environment<span class="op">=</span><span class="st">"env"</span>, response<span class="op">=</span><span class="st">"yield"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="co"># Data with replication</span></span>
<span class="r-in"> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">plrv</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">GGE2</span> <span class="op">&lt;-</span> <span class="fu">GGEmodel</span><span class="op">(</span><span class="va">plrv</span>, genotype <span class="op">=</span> <span class="st">"Genotype"</span>, environment <span class="op">=</span> <span class="st">"Locality"</span>,</span>
<span class="r-in">                  response <span class="op">=</span> <span class="st">"Yield"</span>, rep <span class="op">=</span> <span class="st">"Rep"</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Julia Angelini, Marcos Prunello, Gerardo Cervigni.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

