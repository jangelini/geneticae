<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Imputation of missing cells in two-way data sets — imputation • geneticae</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Imputation of missing cells in two-way data sets — imputation" />
<meta property="og:description" content="Missing values are not allowed by the AMMI or GGE methods. This function
provides several methods to impute missing observations in data from
multi-environment trials and to subsequently adjust the mentioned methods." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geneticae</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/a-tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Functions and datasets reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/b-shiny.html">Shiny APP</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jangelini/geneticae">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Imputation of missing cells in two-way data sets</h1>
    <small class="dont-index">Source: <a href='https://github.com/jangelini/geneticae/blob/master/R/impute.R'><code>R/impute.R</code></a></small>
    <div class="hidden name"><code>imputation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Missing values are not allowed by the AMMI or GGE methods. This function
provides several methods to impute missing observations in data from
multi-environment trials and to subsequently adjust the mentioned methods.</p>
    </div>

    <pre class="usage"><span class='fu'>imputation</span><span class='op'>(</span>
  <span class='va'>Data</span>,
  genotype <span class='op'>=</span> <span class='st'>"gen"</span>,
  environment <span class='op'>=</span> <span class='st'>"env"</span>,
  response <span class='op'>=</span> <span class='st'>"yield"</span>,
  rep <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='st'>"EM-AMMI"</span>,
  nPC <span class='op'>=</span> <span class='fl'>2</span>,
  initial.values <span class='op'>=</span> <span class='cn'>NA</span>,
  precision <span class='op'>=</span> <span class='fl'>0.01</span>,
  maxiter <span class='op'>=</span> <span class='fl'>1000</span>,
  change.factor <span class='op'>=</span> <span class='fl'>1</span>,
  simplified.model <span class='op'>=</span> <span class='cn'>FALSE</span>,
  k <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span><span class='op'>)</span>,
  scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
  method <span class='op'>=</span> <span class='st'>"EM"</span>,
  row.w <span class='op'>=</span> <span class='cn'>NULL</span>,
  coeff.ridge <span class='op'>=</span> <span class='fl'>1</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  nb.init <span class='op'>=</span> <span class='fl'>1</span>,
  Winf <span class='op'>=</span> <span class='fl'>0.8</span>,
  Wsup <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Data</th>
      <td><p>dataframe containing genotypes, environments, repetitions (if any)
and the phenotypic trait of interest. Columns can be in any order in the
dataset and other variables that will not be used in the analysis can be
present.</p></td>
    </tr>
    <tr>
      <th>genotype</th>
      <td><p>column name containing genotypes.</p></td>
    </tr>
    <tr>
      <th>environment</th>
      <td><p>column name containing environments.</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p>column name containing the phenotypic trait.</p></td>
    </tr>
    <tr>
      <th>rep</th>
      <td><p>column name containing replications. If this argument is NULL,
there are no replications available in the data. Defaults to NULL.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>imputation method. Either "EM-AMMI", "EM-SVD",
"Gabriel","WGabriel","EM-PCA". Defaults to "EM-AMMI".</p></td>
    </tr>
    <tr>
      <th>nPC</th>
      <td><p>number of components used to predict the missing values.
Default to 2.</p></td>
    </tr>
    <tr>
      <th>initial.values</th>
      <td><p>initial values of the missing cells. It can be a single
value or a vector of length equal to the number of missing cells (starting
from the missing values in the first column). If omitted, the initial values
will be obtained by the main effects from the corresponding model, that is,
by the grand mean of the observed data increased (or decreased) by row and
column main effects.</p></td>
    </tr>
    <tr>
      <th>precision</th>
      <td><p>threshold for assessing convergence.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>maximum number of iteration for the algorithm.</p></td>
    </tr>
    <tr>
      <th>change.factor</th>
      <td><p>When `change.factor` is equal to 1, the previous
approximation is changed with the new values of missing cells (standard
EM-AMMI algorithm). However, when `change.factor` less than 1, then the new
approximations are computed and the values of missing cells are changed in
the direction of this new approximation but the change is smaller. It could
be useful if the changes are cyclic and thus convergence could not be
reached. Usually, this argument should not affect the final outcome (that
is, the imputed values) as compared to the default value of `change.factor`
= 1.</p></td>
    </tr>
    <tr>
      <th>simplified.model</th>
      <td><p>the AMMI model contains the general mean, effects of
rows, columns and interaction terms. So the EM-AMMI algorithm in step 2
calculates the current effects of rows and columns; these effects change
from iteration to iteration because the empty (at the outset) cells in each
iteration are filled with different values. In step 3 EM-AMMI uses those
effects to re-estimate cells marked as missed (as default,
simplified.model=FALSE). It is, however, possible that this procedure will
not converge. Thus the user is offered a simplified EM-AMMI procedure that
calculates the general mean and effects of rows and columns only in the
first iteration and in next iterations uses these values
(simplified.model=TRUE). In this simplified procedure the initial values
affect the outcome (whilst EM-AMMI results usually do not depend on initial
values). For the simplified procedure the number of iterations to
convergence is usually smaller and, furthermore, convergence will be reached
even in some cases where the regular procedure fails. If the regular
procedure does not converge for the standard initial values, the simplified
model can be used to determine a better set of initial values.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>rank of the SVD approximation.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>boolean. By default TRUE leading to a same weight for each
variable</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"Regularized" by default or "EM"</p></td>
    </tr>
    <tr>
      <th>row.w</th>
      <td><p>row weights (by default, a vector of 1 for uniform row weights)</p></td>
    </tr>
    <tr>
      <th>coeff.ridge</th>
      <td><p>1 by default to perform the regularized imputePCA
algorithm; useful only if method="Regularized". Other regularization terms
can be implemented by setting the value to less than 1 in order to
regularized less (to get closer to the results of the EM method</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>integer, by default seed = NULL implies that missing values are
initially imputed by the mean of each variable. Other values leads to a
random initialization</p></td>
    </tr>
    <tr>
      <th>nb.init</th>
      <td><p>integer corresponding to the number of random initializations;
the first initialization is the initialization with the mean imputation</p></td>
    </tr>
    <tr>
      <th>Winf</th>
      <td><p>peso inferior</p></td>
    </tr>
    <tr>
      <th>Wsup</th>
      <td><p>peso superior</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>imputed data matrix</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paderewski, J. (2013). An R function for imputation of missing
 cells in two-way data sets by EM-AMMI algorithm. Communications in Biometry
 and Crop Science 8, 60–69.</p>
<p>Julie Josse, Francois Husson (2016). missMDA: A Package for
 Handling Missing Values in Multivariate Data Analysis. Journal of
 Statistical Software 70, 1-31.</p>
<p>Arciniegas-Alarcón S., García-Peña M., Dias C.T.S., Krzanowski
 W.J. (2010). <em>An alternative methodology for imputing missing data in
 trials with genotype-by-environment interaction</em>. Biometrical Letters 47,
 1–14.</p>
<p>Perry P.O. (2015). bcv: Cross-Validation for the SVD
 (Bi-Cross-Validation). R package version 1.0.1.</p>
<p>Arciniegas-Alarcón S., García-Peña M., Krzanowski W.J., Dias
 C.T.S. (2014). An alternative methodology for imputing missing data in
 trials with genotype-byenvironment interaction: some new aspects.
 Biometrical Letters 51, 75-88.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jangelini/geneticae'>geneticae</a></span><span class='op'>)</span>
<span class='co'># Data without replications</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>yan.winterwheat</span><span class='op'>)</span>

<span class='co'># generating missing values</span>
<span class='va'>yan.winterwheat</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='cn'>NA</span>
<span class='va'>yan.winterwheat</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='cn'>NA</span>
<span class='va'>yan.winterwheat</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='cn'>NA</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>imputation</span><span class='op'>(</span><span class='va'>yan.winterwheat</span>, genotype <span class='op'>=</span> <span class='st'>"gen"</span>, environment <span class='op'>=</span> <span class='st'>"env"</span>,
           response <span class='op'>=</span> <span class='st'>"yield"</span>, type <span class='op'>=</span> <span class='st'>"EM-AMMI"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Data with replications</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>plrv</span><span class='op'>)</span>
<span class='va'>plrv</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>plrv</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>plrv</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>imputation</span><span class='op'>(</span><span class='va'>plrv</span>, genotype <span class='op'>=</span> <span class='st'>"Genotype"</span>, environment <span class='op'>=</span> <span class='st'>"Locality"</span>,
           response <span class='op'>=</span> <span class='st'>"Yield"</span>, rep <span class='op'>=</span> <span class='st'>"Rep"</span>, type <span class='op'>=</span> <span class='st'>"EM-SVD"</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Julia Angelini, Marcos Prunello, Gerardo Cervigni.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


